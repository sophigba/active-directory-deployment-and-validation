# 2. Environment Architecture and Deployment

This section details the physical configuration and network topology of the lab environment, establishing the foundation for all subsequent validation activities.

## 2.1 Virtualised Architecture Overview

The lab was deployed using VirtualBox on an isolated network segment. This ensured that all components communicated exclusively within the lab environment, simulating an internal enterprise network.

![Logical Diagram](assets/TestLab-Logical-Diagram.jpg)

* **Domain Name:** Mydomain
* **Network Scheme:** 192.168.10.0/24 
* **DNS Resolution:** The Target-PC was configured to use the Windows Server (DC) as the primary DNS resolver.

NOTE - I used a different name when creating the domain on Active directory, hence the difference from what is visible in the Logical diagram.

## 2.2 Component Deployment Breakdown

The four virtual machines and their specific roles were configured as follows:

### A. Target-PC
* **OS:** Windows 10 
* **IP Address:** 192.168.10.x
* **Role:** Served as the primary **RDP Target** for the brute-force simulation.
  
![IP Settings](assets/Target-pc-ip-settings.jpg)
Configured the Target-PC IP settings to match the local network information.
<br><br>

![Added PC to DC](assets/Target-pc-to-domain.jpg)
Added the Target-PC to `mydomain`
<br><br>

![Enable RDP](assets/Target-pc-to-rdp.jpg)
Enabled RDP on the Target-PC
<br><br>

### B. ADDC01
* **OS:** Windows Server 2019
* **IP Address:** 192.168.10.7
* **Function:** Served as the Active Directory Domain Controller and the primary DNS resolver. The user `b.shark` was created here for testing.

![AD Installation](assets/ADDC-installation.jpg)
Installed Active Directory and promoted it to a Domain COntroller (DC)
<br>

![AD Users](assets/ADDC-users.jpg)
Created Users in `mydomain`

### C. Attacker Platform
* **OS:** Kali Linux 
* **IP Address:** 192.168.10.250
* **Fuction:** Used for executing the brute-force attack via **Hydra**.
![Kali-set-up](assets/Kali-set-up.jpg)
<br>

### D. Splunk SIEM
* **OS:** Ubuntu Server
* **IP Address:** 192.168.10.10
* **Function:** It was the destination for all security telemetry logs, acting as the centralized monitoring system.
![Splunk Set up 1](assets/Splunk-set-up-1.jpg)
Configured the splunk server to match the network information.
<br>

![Splunk Set up 2](assets/Splunk-set-up-2.jpg)
Confirmation of splunk server settings.
<br>

![Splunk Set up 3](assets/splunk-set-up-3.jpg)
Successfully created an index on the splunk indexer to receive logs from the machines.
<br>

![Splunk set up 4](assets/splunk-set-up-4.jpg)
Configured the splunk receiving port as `9997`(default)
<br>

## 2.3 Splunk Universal Forwarder and Sysmon Configuration

The key link in the detection chain was the Universal Forwarder (UF) installed on both the Target-PC and the Domain Controller.
* **Function:** Configured to monitor the `Security` log channel and stream the data over port `9997` (default) to the Splunk Indexer.

![Splunk Forwarder set-up](assets/Target-pc-splunk-forwarder.jpg)
Installed Universal Splunk forwarder on both the Target-PC and Domain Controller.
<br><br>

![Forwarder Configuration](assets/splunk-forwarder-config.jpg)
The splunk forwarder was configured to send logs to the `endpoint` index on the Splunk server.
  
![Sysmon Installation](assets/ADDC-sysmon-installation.jpg)
Installed Sysmon on both the Target-PC and the Domain Controller

NOTE - It was essentially the same process on both machines, hence the single snapshots.

![Splunk and Sysmon Installation Configuration](assets/splunk-sysmon-pc-dc-config.jpg)
After setting up the Splunk forwarder and Sysmon on both the Target-PC and Domain Controller, logs were collected in the Indexer confirming the set-up works.
